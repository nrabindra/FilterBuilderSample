{
   "query":{
      "bool":{
         "must":[

         ],
         "filter":[
            {
               "exists":{
                  "field":"Longitude"
               }
            },
            {
               "terms":{
                  "LocationType":[
                     "sgl",
                     "bch",
                     "hq"
                  ]
               }
            },
            {
               "bool":{
                  "must":[
                     {
                        "match":{
                           "OPCO":"RGSOA"
                        }
                     },
                     {
                        "terms":{
                           "HortonStatus":[
                              "active",
                              "inactive",
                              "lapsed",
                              "engaged",
                              "visited",
                              "unvisited",
                              "qualified",
                              "new"
                           ]
                        }
                     },
                     {
                        "terms":{
                           "Color":[
                              "blue",
                              "green",
                              "orange",
                              "pink",
                              "undefined"
                           ]
                        }
                     },
                     {
                        "nested":{
                           "path":"BizOwner",
                           "query":{
                              "bool":{
                                 "must":[
                                    {
                                       "match":{
                                          "BizOwner.OwnerUserID":"RABINN01"
                                       }
                                    },
                                    {
                                       "terms":{
                                          "BizOwner.Segment":[
                                             "sales"
                                          ]
                                       }
                                    },
                                    {
                                       "terms":{
                                          "BizOwner.AccountType2":[
                                             "t10"
                                          ]
                                       }
                                    }
                                 ]
                              }
                           }
                        }
                     }
                  ]
               }
            }
         ],
         "must_not":[
            {
               "bool":{
                  "must":[
                     {
                        "bool":{
                           "must_not":[
                              {
                                 "nested":{
                                    "path":"BizOwner",
                                    "query":{
                                       "match":{
                                          "BizOwner.OwnerUserID":"RABINN01"
                                       }
                                    }
                                 }
                              }
                           ]
                        }
                     },
                     {
                        "terms":{
                           "GridPos":[
                              "u4"
                           ]
                        }
                     }
                  ]
               }
            }
         ]
      }
   },
   "aggs":{
      "centroid":{
         "geo_centroid":{
            "field":"Location"
         }
      },
      "opco":{
         "terms":{
            "field":"OPCO.raw"
         },
         "aggs":{
            "gridpos":{
               "terms":{
                  "field":"GridPos.raw",
                  "size":21
               }
            }
         }
      }
   }
}